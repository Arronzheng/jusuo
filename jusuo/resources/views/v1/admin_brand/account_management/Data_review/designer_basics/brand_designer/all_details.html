<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <!--使用layui的话，这个一定要带上，否则样式会不兼容-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta content="email=no" name="format-detection">
    <meta name="description" content="超弦网络"/>
    <meta name="keywords" content=""/>
    <meta content="超弦网络" name="超弦网络"/>
    <title>管理员端</title>

    <!--全局基本都要用的js放这里 start-->
    <script src="http://cdn.bootcss.com/jquery/2.2.3/jquery.min.js"></script>
    <script src="http://pf.fsqmh.com/plugins/layui-v2.5.4/layui/layui.all.js"></script>
    <script type="text/javascript" src="https://cdn.bootcss.com/layer/2.3/layer.js"></script>
    <!--兼容各浏览器的placeholder插件-->
    <script src="https://cdn.bootcss.com/jquery-placeholder/2.3.1/jquery.placeholder.min.js"></script>
    <script src="http://pf.fsqmh.com/v1/js/ajax.js"></script>
    <script src="http://pf.fsqmh.com/v1/js/util.js"></script>
    <script src="http://pf.fsqmh.com/v1/js/sub_nav.js"></script>
    <!--全局基本都要用的js放这里 end-->

    <!--全局基本都要用的css放这里 start-->
    <link rel="stylesheet" href="http://pf.fsqmh.com/plugins/layui-v2.5.4/layui/css/layui.css">
    <link rel="stylesheet" href="http://pf.fsqmh.com/v1/css/admin/global.css">
    <link rel="stylesheet" href="http://pf.fsqmh.com/v1/css/admin/layout.css">
    <!--全局基本都要用的css放这里 end-->

    <link rel="stylesheet" href="http://pf.fsqmh.com/v1/css/admin/module/form.css">



</head>
<body class="layui-layout-body">
<div class="layui-layout layui-layout-admin">
    <div class="layui-header">
        <ul class="layui-nav c-header-nav" lay-filter="">
            <li class="layui-nav-item">
                <a href="javascript:;">管理员</a>
                <dl class="layui-nav-child"> <!-- 二级菜单 -->
                    <dd><a href="javascript:;">退出登录</a></dd>
                </dl>
            </li>
        </ul>
    </div>

    <div class="layui-side layui-bg-black">
        <div class="layui-side-scroll">
            <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
            <ul class="layui-nav layui-nav-tree c-side-menu" id="side-nav-ul">
                <div class="layui-logo">管理后台</div>
                <li class="layui-nav-item layui-nav-itemed">
                    <a href="javascript:;">首页</a>
                </li>
            </ul>
        </div>
    </div>

    <div class="layui-body">

        <div class="layui-form" lay-filter="layuiadmin-app-form-list" id="layuiadmin-app-form-list" style="padding: 20px 30px 0 0;">
            <form>
                <div class="layui-form-item">
                    <label class="layui-form-label">统一账号</label>
                    <div class="layui-input-inline">
                        <input type="text" name="designer_account" value="" lay-verify="required"  autocomplete="off" class="layui-input">
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">登录名</label>
                    <div class="layui-input-inline">
                        <input name="login_username" lay-verify="required" value="" autocomplete="off" class="layui-input"/>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">真实姓名</label>
                    <div class="layui-input-inline">
                        <input name="realname" lay-verify="required" value="" autocomplete="off" class="layui-input"/>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">手机号</label>
                    <div class="layui-input-inline">
                        <input name="login_telephone" lay-verify="required" value="" autocomplete="off" class="layui-input"/>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">性别</label>
                    <div class="layui-input-block">
                        <input type="radio" name="sex" value="0" title="男">
                        <input type="radio" name="sex" value="1" title="女" checked>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">省市区</label>
                    <div class="layui-input-block">
                        <div class="layui-input-inline">
                            <select lay-verify="required" lay-filter="areaServingProvinceId">
                                <option value="">请选择省</option>
                            </select>
                        </div>
                        <div class="layui-input-inline">
                            <select id="area_serving_city_id" name="area_serving_id" lay-verify="required" lay-filter="areaServingCityId">
                                <option value="">请选择城市</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">设计师类型</label>
                    <div class="layui-input-inline">
                        <select name="designer_account_type_text" lay-verify="required">
                            <option value="">请选择标签</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">工作单位</label>
                    <div class="layui-input-inline">
                        <input name="organization" lay-verify="required" value="" autocomplete="off" class="layui-input"/>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">方案数</label>
                    <div class="layui-input-inline">
                        <input name="album_count" lay-verify="required" value=""  autocomplete="off" class="layui-input"/>
                    </div>
                </div>

                <div class="layui-form-item">
                    <div class="layui-inline filter-block">
                        <label class="layui-form-label">状态：</label>
                        <div class="layui-input-inline" style="padding-right: 14px">
                            <select name="status_text" lay-verify="">
                                <option value="">全部</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <div class="layui-inline filter-block">
                        <label class="layui-form-label">实名认证：</label>
                        <div class="layui-input-inline" style="padding-right: 14px">
                            <select name="cert_text" lay-verify="">
                                <option value="">是</option>
                                <option value="">否</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">创建时间</label>
                    <div class="layui-input-inline">
                        <input name="created_at" lay-verify="required"  value="" autocomplete="off" class="layui-input"/>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">实名认证时间</label>
                    <div class="layui-input-inline">
                        <input name="certed_at" lay-verify="required"  value="" autocomplete="off" class="layui-input"/>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">上次登录时间</label>
                    <div class="layui-input-inline">
                        <input name="last_active_time" lay-verify="required"  value="" autocomplete="off" class="layui-input"/>
                    </div>
                </div>
                <div class="layui-form-item submit-container">
                    <div class="layui-input-block">
                        <input type="hidden" name="id" value="" />
                        <button class="layui-btn layui-btn-custom-blue" id="submitBtn" lay-submit lay-filter="submitFormBtn">立即提交</button>
                    </div>
                </div>
            </form>

        </div>


    </div>

</div>

<script src="http://pf.fsqmh.com/v1/js/admin/module/form.js"></script>
<!--初始化专用script-->
<script>
    //JavaScript代码区域
    //layui后台模板依赖element模块，如果以非模块化方式加载js，则需要对依赖模块进行init。
    var form = layui.form;
    layui.element.init();

    /*文件上传*/
    let upload = layui.upload;
    var img_size = 2*1024;
    var uploadImg = upload.render({
        elem: '#b-upload-img'
        ,url: 'xxx'
        ,data: {'_token':''}
        ,size:img_size  //KB
        ,acceptMime: 'image/jpeg,image/jpg,image/png'
        ,before: function(obj){layer.load(1);}
        ,done: function(res){
            layer.closeAll('loading');
            //如果上传失败
            if(!res.status){
                layer.msg(res.msg);
            }
            //上传成功
            var upload_btn = $($(this)[0].item[0]);//点击触发的当前元素
            var access_path = res.data.access_path;  //本地访问url
            upload_btn.find('.upload-img-preview').css('background-image','url('+access_path+')');
            upload_btn.find('input').val(access_path);
        }
    });
    /*文件上传*/

    /*富文本编辑器*/
    let layedit = layui.layedit;
    //创建一个编辑器
    layedit.set({
        uploadImage: {
            url: 'xxx' //接口url
            ,type: '' //默认post
        }
    });
    var editor1 = layedit.build('editor-instance');
    /*富文本编辑器*/

    /*自定义form验证*/
    form.verify({
        avatar_photo: function(value){ //value：表单的值、item：表单的DOM对象
            if(value == ''){
                return '请上传图片';
            }
        },
    });
    /*自定义form验证*/

    form.render();

</script>

<!--页面方法专用script-->
<script>

    let submitAction = "";
    let submitMethod = "";

    //提交Form信息
    form.on('submit(submitFormBtn)', function(form_info){
        //显示loading
        layer.load(1);
        //将提交按钮设置不可用
        $('#submitBtn').attr('disabled',true);

        var form_field = form_info.field;
        //处理富文本：将富文本内容同步到表单域汇总
        form_field.desc = layedit.getContent(editor1);
        //处理开关控件：需要将其转换成数值
        if(!form_field.status) {
            form_field.status = "0";
        }
        //处理复选框：原layui的checkbox获取值机制比较麻烦，所以使用jq方式获取
        var chk_value =[];
        $('.cbHobby:checked').each(function(){
            chk_value.push(this.value); //push 进数组
        });
        form_field.hobby = chk_value;

        //提交方式
        if(submitMethod){
            form_field._method = submitMethod;
        }

        ajax_post(submitAction,
                form_field,
                function(result){
                    if(result.status){
                        layer.msg(result.msg, {
                            time: 1500
                        }, function(){
                            parent.reloadTable();
                            var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
                            parent.layer.close(index); //再执行关闭

                        });
                    }else{
                        //将提交按钮恢复
                        $('#submitBtn').attr('disabled',false);
                        layer.msg(result.msg);
                    }
                },function(result){
                    //将提交按钮恢复
                    $('#submitBtn').attr('disabled',false);
                    layer.msg('操作失败');
                });

        return false; //阻止表单跳转。如果需要表单跳转，去掉这段即可。
    });
</script>

</body>
</html>